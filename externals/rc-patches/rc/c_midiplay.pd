#N canvas 132 46 480 338 10;
#X declare -stdpath mrpeach;
#X obj 316 13 inlet;
#X obj 315 249 declare -stdpath mrpeach;
#X obj 28 14 inlet;
#X obj 105 206 s \$0-file;
#X obj 143 150 s \$0-reopen;
#X msg 143 125 bang;
#X obj 133 273 outlet ticks;
#N canvas 104 56 486 367 midifile 0;
#X msg 45 103 rewind;
#X msg 179 171 read \$1;
#X obj 57 130 loadbang;
#X msg 57 158 verbose 0;
#X obj 132 104 symbol;
#X obj 20 332 outlet midi;
#X obj 142 75 u_list2symbol;
#X obj 142 48 r \$0-file;
#X obj 132 19 r \$0-reopen;
#X obj 20 222 midifile;
#X obj 20 19 inlet ticks;
#X obj 45 75 r \$0-rewind;
#X obj 147 198 s \$0-rewind;
#X obj 129 332 outlet info;
#X obj 20 292 spigot;
#X msg 263 171 0;
#X obj 132 129 t b b b a b;
#X msg 132 223 1;
#N canvas 284 208 567 438 tempo 0;
#X obj 45 16 inlet;
#X obj 237 111 unpack f f f f;
#X msg 163 378 bpm \$1;
#X obj 163 238 /;
#X msg 163 210 6e+07 \$1;
#X obj 45 407 outlet;
#X obj 83 211 /;
#X obj 83 239 / 1000;
#X obj 83 272 s \$0-file_tempo;
#X text 444 137 stop at end of file;
#X obj 417 242 spigot;
#X obj 417 271 s \$0-run;
#X obj 390 327 s \$0-rewind;
#X msg 417 138 0;
#X obj 450 190 sel 0;
#X msg 450 215 1;
#X msg 482 216 0;
#X obj 450 164 r \$0-loop;
#X obj 390 298 delay 2;
#X obj 83 56 route microsec_per_quarternote ticks_per_quarternote time_sig
bang;
#X obj 390 109 t b b;
#X obj 160 174 s \$0-ticksperbeat;
#X obj 200 238 r \$0-bpm;
#X text 242 193 send bpm if changed;
#X obj 237 141 s \$0-beatspermeasure;
#X obj 262 239 r \$0-file;
#X obj 282 263 r \$0-reopen;
#X obj 262 327 delay 5;
#X obj 163 295 t f b;
#X msg 262 352 120;
#X msg 190 322 stop;
#X obj 262 294 t b;
#X msg 312 382 time_sig 4 4 0 0;
#X text 291 352 send default values if no file info;
#X obj 324 327 delay 5;
#X msg 324 296 stop;
#X connect 0 0 5 0;
#X connect 0 0 19 0;
#X connect 1 0 24 0;
#X connect 1 0 35 0;
#X connect 2 0 5 0;
#X connect 3 0 28 0;
#X connect 4 0 3 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 10 0 11 0;
#X connect 13 0 10 0;
#X connect 14 0 15 0;
#X connect 14 1 16 0;
#X connect 15 0 10 1;
#X connect 16 0 10 1;
#X connect 17 0 14 0;
#X connect 18 0 12 0;
#X connect 19 0 4 0;
#X connect 19 0 6 0;
#X connect 19 1 6 1;
#X connect 19 1 21 0;
#X connect 19 2 1 0;
#X connect 19 3 20 0;
#X connect 20 0 18 0;
#X connect 20 1 13 0;
#X connect 22 0 2 0;
#X connect 25 0 31 0;
#X connect 26 0 31 0;
#X connect 27 0 29 0;
#X connect 28 0 2 0;
#X connect 28 1 30 0;
#X connect 29 0 2 0;
#X connect 30 0 27 0;
#X connect 31 0 27 0;
#X connect 31 0 34 0;
#X connect 32 0 5 0;
#X connect 34 0 32 0;
#X connect 35 0 34 0;
#X restore 129 295 pd tempo and loop;
#X text 223 128 bang once after loading file to get info;
#X text 135 262 use spigot to catch first note when getting info;
#N canvas 469 254 210 155 reset 0;
#X obj 16 17 inlet;
#X msg 16 43 bang;
#X obj 16 68 \$0;
#X msg 16 93 \; \$1-file_tempo 2.60417 \; \$1-ticksperbeat 192 \; \$1-beatspermeasure
4;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X restore 262 203 pd reset tempo;
#X connect 0 0 9 0;
#X connect 1 0 9 0;
#X connect 2 0 3 0;
#X connect 3 0 9 0;
#X connect 3 0 17 0;
#X connect 4 0 16 0;
#X connect 6 0 4 0;
#X connect 7 0 6 0;
#X connect 8 0 4 0;
#X connect 9 0 14 0;
#X connect 9 2 18 0;
#X connect 10 0 9 0;
#X connect 11 0 0 0;
#X connect 14 0 5 0;
#X connect 15 0 14 1;
#X connect 16 0 17 0;
#X connect 16 1 12 0;
#X connect 16 2 9 0;
#X connect 16 3 1 0;
#X connect 16 4 15 0;
#X connect 16 4 21 0;
#X connect 17 0 14 1;
#X connect 18 0 13 0;
#X restore 28 273 pd midifile;
#N canvas 42 147 483 543 midi 0;
#X obj 25 12 inlet run;
#N canvas 126 213 237 192 bpm2miditick 0;
#X obj 43 30 inlet;
#X obj 43 164 outlet;
#X obj 43 133 / 192;
#X obj 43 59 swap 60000;
#X obj 43 85 /;
#X obj 70 109 r \$0-ticksperbeat;
#X text 92 85 1 tick = 768 us;
#X connect 0 0 3 0;
#X connect 2 0 1 0;
#X connect 3 0 4 0;
#X connect 3 1 4 1;
#X connect 4 0 2 0;
#X connect 5 0 2 1;
#X restore 91 122 pd bpm2miditick;
#X obj 91 95 r \$0-bpm;
#X obj 247 451 f;
#X obj 283 452 + 1;
#X msg 180 297 0;
#X obj 247 394 int;
#X obj 247 421 change;
#X obj 268 139 / 4;
#X obj 160 324 f;
#X obj 201 324 + 1;
#X obj 268 79 t b f;
#X obj 316 80 r \$0-ticksperbeat;
#X obj 247 366 / 48;
#X text 283 366 192/4;
#X obj 268 163 int;
#X obj 247 501 outlet ticks;
#X text 274 186 192 midi ticks / beat;
#X obj 133 239 * 48;
#X obj 133 268 t f f;
#X text 260 475 pos in beat ticks;
#X text 229 323 pos in midi ticks;
#X obj 25 304 t b b;
#X obj 133 215 int;
#X obj 52 503 outlet bangs;
#X obj 39 43 r \$0-run;
#X obj 180 270 r \$0-rewind;
#X obj 309 112 moses 1;
#X obj 133 190 r \$0-pos;
#X obj 25 148 metro 4;
#X obj 38 190 r \$0-bang;
#X obj 38 268 until;
#X obj 38 243 f;
#X obj 268 112 f 192;
#X obj 64 69 r \$0-file_tempo;
#X obj 268 39 r \$0-beatspermeasure;
#X text 300 162 calc length of 1 beat tick;
#X connect 0 0 29 0;
#X connect 1 0 29 1;
#X connect 2 0 1 0;
#X connect 3 0 4 0;
#X connect 3 0 16 0;
#X connect 4 0 3 1;
#X connect 5 0 9 0;
#X connect 6 0 7 0;
#X connect 7 0 3 0;
#X connect 8 0 15 0;
#X connect 9 0 10 0;
#X connect 9 0 13 0;
#X connect 10 0 9 1;
#X connect 11 0 33 0;
#X connect 11 1 27 0;
#X connect 12 0 33 1;
#X connect 13 0 6 0;
#X connect 15 0 13 1;
#X connect 15 0 18 1;
#X connect 15 0 32 1;
#X connect 18 0 19 0;
#X connect 19 0 24 0;
#X connect 19 1 9 0;
#X connect 22 0 9 0;
#X connect 22 1 24 0;
#X connect 23 0 18 0;
#X connect 25 0 29 0;
#X connect 26 0 5 0;
#X connect 27 1 8 1;
#X connect 28 0 23 0;
#X connect 29 0 22 0;
#X connect 30 0 32 0;
#X connect 31 0 22 0;
#X connect 32 0 31 0;
#X connect 33 0 8 0;
#X connect 34 0 29 1;
#X connect 35 0 11 0;
#X restore 28 236 pd midi tick metro;
#N canvas 134 125 577 258 midi 0;
#X obj 27 38 inlet midi;
#N canvas 266 248 259 228 ctlin 0;
#X obj 24 26 inlet;
#X obj 24 61 unpack f f f;
#X obj 24 122 pack f f f;
#X text 114 63 event+chan ctl val;
#X text 106 119 chan ctl val;
#X text 134 156 val ctl chan;
#X msg 24 151 \; #ctlin \$3 \$2 \$1;
#X obj 24 91 - 175;
#X connect 0 0 1 0;
#X connect 1 0 7 0;
#X connect 1 1 2 1;
#X connect 1 2 2 2;
#X connect 2 0 6 0;
#X connect 7 0 2 0;
#X restore 165 197 pd ctlin;
#X text 11 8 parse the raw bytes and send to built in midi objects
;
#N canvas 109 375 234 206 pgmin 0;
#X obj 41 25 inlet;
#X obj 41 117 pack f f;
#X obj 98 88 + 1;
#X text 104 116 chan pgm;
#X text 113 55 event+chan pgm;
#X obj 41 57 unpack f f;
#X text 140 147 chan pgm;
#X msg 41 149 \; #pgmin \$2 \$1;
#X obj 41 87 - 191;
#X connect 0 0 5 0;
#X connect 1 0 7 0;
#X connect 2 0 1 1;
#X connect 5 0 8 0;
#X connect 5 1 2 0;
#X connect 8 0 1 0;
#X restore 313 193 pd pgmin;
#N canvas 266 248 237 234 bendin 0;
#X obj 24 26 inlet;
#X obj 24 61 unpack f f f;
#X text 114 63 event+chan lo hi;
#X obj 93 92 << 7;
#X obj 69 120 +;
#X text 94 148 chan val;
#X obj 24 149 pack f f;
#X msg 24 179 \; #bendin \$1 \$2;
#X obj 24 91 - 223;
#X connect 0 0 1 0;
#X connect 1 0 8 0;
#X connect 1 1 4 0;
#X connect 1 2 3 0;
#X connect 3 0 4 1;
#X connect 4 0 6 1;
#X connect 6 0 7 0;
#X connect 8 0 6 0;
#X restore 211 167 pd bendin;
#N canvas 109 375 234 207 touchin 0;
#X obj 41 25 inlet;
#X obj 41 118 pack f f;
#X obj 41 58 unpack f f;
#X text 113 56 event+chan val;
#X text 104 117 chan val;
#X text 140 148 chan val;
#X msg 41 150 \; #touchin \$2 \$1;
#X obj 41 88 - 223;
#X connect 0 0 2 0;
#X connect 1 0 6 0;
#X connect 2 0 7 0;
#X connect 2 1 1 1;
#X connect 7 0 1 0;
#X restore 356 164 pd touchin;
#N canvas 266 248 266 202 polytouchin 0;
#X obj 24 26 inlet;
#X obj 24 59 unpack f f f;
#X obj 24 120 pack f f f;
#X text 113 61 event+chan note val;
#X text 106 117 chan note val;
#X text 161 158 val note chan;
#X msg 24 149 \; #polytouchin \$3 \$2 \$1;
#X obj 24 89 - 159;
#X connect 0 0 1 0;
#X connect 1 0 7 0;
#X connect 1 1 2 1;
#X connect 1 2 2 2;
#X connect 2 0 6 0;
#X connect 7 0 2 0;
#X restore 119 228 pd polytouchin;
#N canvas 447 211 523 210 notein 0;
#X obj 34 21 inlet;
#X obj 34 54 unpack f f f;
#X obj 34 115 pack f f f;
#X text 120 52 event+chan note vel;
#X text 110 113 chan note vel;
#X text 159 146 note vel chan;
#X obj 34 85 - 127;
#X obj 265 54 unpack f f f;
#X obj 265 115 pack f f f;
#X text 351 52 event+chan note vel;
#X text 341 113 chan note vel;
#X text 387 146 note vel chan;
#X obj 265 85 - 143;
#X msg 34 145 \; #notein \$2 0 \$1;
#X msg 265 145 \; #notein \$2 \$3 \$1;
#X obj 265 22 inlet;
#X connect 0 0 1 0;
#X connect 1 0 6 0;
#X connect 1 1 2 1;
#X connect 1 2 2 2;
#X connect 2 0 13 0;
#X connect 6 0 2 0;
#X connect 7 0 12 0;
#X connect 7 1 8 1;
#X connect 7 2 8 2;
#X connect 8 0 14 0;
#X connect 12 0 8 0;
#X connect 15 0 7 0;
#X restore 27 229 pd notein;
#N canvas 531 118 390 442 detect 0;
#X obj 16 14 inlet;
#X obj 145 140 moses 160;
#X text 210 141 poly aftertouch;
#X obj 196 170 moses 176;
#X text 263 170 control change;
#X obj 247 202 moses 208;
#X obj 298 229 moses 223;
#X text 313 203 pitch bend;
#X obj 43 82 moses 128;
#X obj 94 110 moses 144;
#X text 108 81 noteoff;
#X text 161 110 noteon;
#X obj 16 350 list prepend;
#X obj 16 47 t a a;
#X msg 94 169 noteoff;
#X msg 145 201 noteon;
#X obj 16 377 list trim;
#X msg 196 228 polytouch;
#X obj 16 404 outlet;
#X msg 247 260 ctl;
#X msg 298 286 bend;
#X connect 0 0 13 0;
#X connect 1 0 15 0;
#X connect 1 1 3 0;
#X connect 3 0 17 0;
#X connect 3 1 5 0;
#X connect 5 0 19 0;
#X connect 5 1 6 0;
#X connect 6 0 20 0;
#X connect 8 1 9 0;
#X connect 9 0 14 0;
#X connect 9 1 1 0;
#X connect 12 0 16 0;
#X connect 13 0 12 0;
#X connect 13 1 8 0;
#X connect 14 0 12 1;
#X connect 15 0 12 1;
#X connect 16 0 18 0;
#X connect 17 0 12 1;
#X connect 19 0 12 1;
#X connect 20 0 12 1;
#X restore 27 106 pd detect message type from status byte;
#N canvas 849 157 298 325 detect 0;
#X obj 16 14 inlet;
#X obj 16 234 list prepend;
#X obj 16 47 t a a;
#X obj 16 261 list trim;
#X obj 16 288 outlet;
#X obj 43 79 moses 192;
#X text 107 79 program change;
#X text 211 140 aftertouch;
#X obj 94 110 moses 208;
#X obj 145 139 moses 224;
#X obj 196 169 moses 240;
#X msg 94 170 pgm;
#X msg 196 197 touch;
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X connect 2 1 5 0;
#X connect 3 0 4 0;
#X connect 5 1 8 0;
#X connect 8 0 11 0;
#X connect 8 1 9 0;
#X connect 9 1 10 0;
#X connect 10 0 12 0;
#X connect 11 0 1 1;
#X connect 12 0 1 1;
#X restore 313 105 pd detect message type from status byte;
#X obj 27 136 route noteoff noteon polytouch ctl bend;
#X obj 313 135 route pgm touch;
#X obj 313 76 u_listlastx 2;
#X obj 27 74 u_listlastx 3;
#X connect 0 0 12 0;
#X connect 0 0 13 0;
#X connect 8 0 10 0;
#X connect 9 0 11 0;
#X connect 10 0 7 0;
#X connect 10 1 7 1;
#X connect 10 2 6 0;
#X connect 10 3 1 0;
#X connect 10 4 4 0;
#X connect 11 0 3 0;
#X connect 11 1 5 0;
#X connect 12 0 9 0;
#X connect 13 0 8 0;
#X restore 28 304 pd midi sends;
#X msg 182 72 bang;
#X obj 182 97 s \$0-rewind;
#N canvas 172 83 586 377 LICENSE-GPL 0;
#X text 57 88 This program is free software: you can redistribute it
and/or modify it under the terms of the GNU General Public License
as published by the Free Software Foundation \, either version 3 of
the License \, or (at your option) any later version.;
#X text 58 168 This program is distributed in the hope that it will
be useful \, but WITHOUT ANY WARRANTY \; without even the implied warranty
of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
General Public License for more details.;
#X text 57 261 You should have received a copy of the GNU General Public
License along with this program. If not \, see <http://www.gnu.org/licenses/>.
;
#X text 60 325 See the file LICENSE.txt for the full license text.
;
#X text 56 54 Copyright (C) 2012 \, Dan Wilcox <danomatika@gmail.com>
;
#X restore 315 217 pd LICENSE-GPL;
#N canvas 645 99 216 149 pdefaults 0;
#X obj 22 77 outlet;
#X obj 22 18 loadbang;
#X msg 84 79 4;
#X obj 84 107 s \$0-ticksperbeat;
#X msg 22 47 bpm 120 \, loop 0;
#X connect 1 0 4 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 4 0 0 0;
#X restore 376 13 pd pdefaults;
#X obj 220 72 s \$0-pos;
#X obj 28 44 route float bang open reopen rewind set;
#X obj 66 71 s \$0-bang;
#X obj 174 304 outlet info;
#X obj 316 44 route bpm loop;
#X obj 316 98 s \$0-bpm;
#X obj 356 72 s \$0-loop;
#N canvas 780 235 159 167 arg1 0;
#X obj 19 18 loadbang;
#X obj 19 101 select symbol;
#X obj 94 71 symbol;
#X obj 19 44 t b b;
#X obj 94 128 outlet;
#X obj 19 71 symbol \$1;
#X connect 0 0 3 0;
#X connect 1 1 4 0;
#X connect 2 0 1 1;
#X connect 3 0 5 0;
#X connect 3 1 2 0;
#X connect 5 0 1 0;
#X restore 116 176 pd arg1;
#X connect 0 0 18 0;
#X connect 2 0 15 0;
#X connect 5 0 4 0;
#X connect 7 0 9 0;
#X connect 7 1 17 0;
#X connect 8 0 7 0;
#X connect 8 1 6 0;
#X connect 10 0 11 0;
#X connect 13 0 18 0;
#X connect 15 0 8 0;
#X connect 15 1 16 0;
#X connect 15 2 3 0;
#X connect 15 3 5 0;
#X connect 15 4 10 0;
#X connect 15 5 14 0;
#X connect 18 0 19 0;
#X connect 18 1 20 0;
#X connect 21 0 3 0;
