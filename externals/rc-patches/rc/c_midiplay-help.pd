#N canvas 222 49 909 521 10;
#X declare -stdpath mrpeach;
#X declare -stdpath mrpeach;
#N canvas 112 97 487 481 REFERENCE 0;
#X text 24 31 Name: [c_midiplay];
#X text 24 51 Summary: plays back a midi file to the internal midi
objects \, settable the bpm and pos;
#X text 24 283 Outlet 1: bangs on end of file;
#X text 24 434 Tags: midi \, playback \, sequencing;
#X text 24 91 Argument 0: <symbol> optional file to open on creation
;
#X text 24 400 See also: [midifile] [c_seqplay] [c_nstep];
#X text 24 122 Inlet 0: <float> - start stop playback \, "open" <symbol>
- open a midi file \, "reopen" - reopen the current file \, "rewind"
- rewind to file start \, "set" <float> - set the tick pos;
#X text 24 191 Inlet 1: "bpm" <float> - beats per minute \, "loop"
<float> - loop the midi file (0-1);
#X text 24 232 Outlet 0: current tick \, these aren't midi ticks but
calculated from # midi ticks per beat / number beats per measure;
#X text 24 311 Description: This is a convenience wrapper around mrpeach
[midifile] and thus requires the mrpeach external. It sends to the
internal pd midi input objects ([notein] [ctlin] etc) for you. The
bpm is calculated from the file tempo info. If the file has no bpm
and/or time sig \, then 120 & 4/4 are used as per the MIDI file specification.
;
#X coords 0 -1 1 1 450 450 1 10 10;
#X restore 5 48 pd REFERENCE;
#X obj 5 18 cnv 15 450 20 empty empty empty 20 12 0 14 -261234 -66577
0;
#X text 468 51 Example:;
#X obj 499 440 soundoutput;
#X text 495 488 rc-patches (https://github.com/danomatika/rc-patches)
- 2013;
#X obj 489 79 tgl 15 0 empty empty run 17 7 0 10 -262144 -1 -1 1 1
;
#X msg 556 155 reopen;
#X floatatom 542 304 5 0 0 1 ticks - -;
#X obj 695 336 bng 15 250 50 0 empty empty end 17 7 0 10 -262144 -1
-1;
#X obj 695 207 g_hsl bpm 80 200;
#X msg 564 184 rewind;
#X text 613 184 rewind to start;
#X obj 695 242 g_tgl loop;
#X floatatom 577 220 5 0 0 1 tick_pos - -;
#X msg 480 199 bang;
#X obj 542 46 openpanel;
#X msg 542 127 open \$1;
#X msg 577 244 set \$1;
#X obj 740 365 unpack 0 0 0 0;
#X floatatom 740 398 3 0 0 1 / - -;
#X floatatom 769 398 3 0 0 1 - - -;
#X obj 695 306 route bang time_sig bpm;
#X floatatom 785 337 5 0 0 1 bpm - -;
#N canvas 871 314 349 330 show 0;
#X obj 161 28 inlet;
#X obj 34 27 inlet;
#X msg 61 109 reset;
#X obj 34 191 sel 0;
#X obj 34 139 u_count 32;
#X obj 34 166 mod 4;
#X obj 34 223 u_count 4;
#X obj 61 83 sel 0;
#X obj 34 57 t b a;
#X obj 161 62 unpack f f;
#X obj 161 95 *;
#X obj 34 252 sel 0;
#X obj 34 296 outlet;
#X obj 86 296 outlet;
#X text 132 137 count # ticks per beat;
#X text 110 222 count # beats per measure;
#X text 44 4 this is kinda hacky \, but it seems to work;
#X connect 0 0 9 0;
#X connect 1 0 8 0;
#X connect 2 0 4 0;
#X connect 2 0 6 0;
#X connect 3 0 6 0;
#X connect 4 0 5 0;
#X connect 5 0 3 0;
#X connect 6 0 11 0;
#X connect 7 0 2 0;
#X connect 8 0 4 0;
#X connect 8 1 7 0;
#X connect 9 0 10 0;
#X connect 9 0 6 1;
#X connect 9 0 5 1;
#X connect 9 1 10 1;
#X connect 10 0 4 1;
#X connect 11 0 12 0;
#X connect 11 1 13 0;
#X restore 542 330 pd show beat;
#X obj 740 424 pack f f;
#X obj 542 359 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 611 359 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 542 23 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X msg 628 75 symbol media/Fugue.mid;
#X text 796 398 time signature;
#X obj 542 277 c_midiplay media/Fugue.mid;
#X text 710 278 outputs bpm & [midifile] info;
#X msg 615 47 symbol media/billy_idol-rebel_yell.mid;
#X text 459 178 advance 1 tick;
#X msg 642 102 symbol media/test_midi.mid;
#N canvas 115 155 584 382 simple 0;
#X obj -41 38 notein;
#X floatatom -8 64 5 0 0 0 - - -;
#X floatatom -25 86 5 0 0 0 - - -;
#X floatatom -41 108 5 0 0 0 - - -;
#X obj 53 39 ctlin;
#X floatatom 80 67 5 0 0 0 - - -;
#X floatatom 66 91 5 0 0 0 - - -;
#X floatatom 53 115 5 0 0 0 - - -;
#X obj 144 39 pgmin;
#X floatatom 171 67 5 0 0 0 - - -;
#X floatatom 144 92 5 0 0 0 - - -;
#X obj -41 133 pack f f;
#X obj -41 157 list prepend;
#X obj -41 351 outlet~;
#X obj 178 352 outlet~;
#X msg 8 270 sn;
#X msg 43 270 cp;
#X msg 75 271 hh;
#X obj -41 240 sel 35 36 38 40 39 42 46;
#X msg 107 272 oh;
#X obj -41 307 s_drumelectro;
#X obj 144 241 list split 1;
#X obj 178 300 *~ 0.45;
#X obj 237 39 bendin;
#X floatatom 270 67 5 0 0 0 - - -;
#X floatatom 237 90 5 0 0 0 - - -;
#X floatatom 367 66 5 0 0 0 - - -;
#X floatatom 328 89 5 0 0 0 - - -;
#X obj 328 38 touchin;
#X floatatom 490 65 5 0 0 0 - - -;
#X floatatom 458 89 5 0 0 0 - - -;
#X floatatom 427 113 5 0 0 0 - - -;
#X obj 427 37 polytouchin;
#X obj 178 272 u_makepolymono 14 1 s_rhodey \$0-rhodeys;
#X obj -41 194 route 10 11;
#X text 136 11 recieve midi data as usual;
#X msg -41 270 bd 250;
#X text 127 157 this is a very basic general midi player;
#X text 43 198 chans 10 & 11 for drums;
#X text 229 240 instrument channels;
#X connect 0 0 3 0;
#X connect 0 1 2 0;
#X connect 0 2 1 0;
#X connect 1 0 12 1;
#X connect 2 0 11 1;
#X connect 3 0 11 0;
#X connect 4 0 7 0;
#X connect 4 1 6 0;
#X connect 4 2 5 0;
#X connect 8 0 10 0;
#X connect 8 1 9 0;
#X connect 11 0 12 0;
#X connect 12 0 34 0;
#X connect 15 0 20 0;
#X connect 16 0 20 0;
#X connect 17 0 20 0;
#X connect 18 0 36 0;
#X connect 18 1 36 0;
#X connect 18 2 15 0;
#X connect 18 3 15 0;
#X connect 18 4 16 0;
#X connect 18 5 17 0;
#X connect 18 6 19 0;
#X connect 19 0 20 0;
#X connect 20 0 14 0;
#X connect 20 0 13 0;
#X connect 21 1 33 0;
#X connect 22 0 14 0;
#X connect 22 0 13 0;
#X connect 23 0 25 0;
#X connect 23 1 24 0;
#X connect 28 0 27 0;
#X connect 28 1 26 0;
#X connect 32 0 31 0;
#X connect 32 1 30 0;
#X connect 32 2 29 0;
#X connect 33 0 22 0;
#X connect 34 0 18 0;
#X connect 34 1 18 0;
#X connect 34 2 21 0;
#X connect 36 0 20 0;
#X restore 499 405 pd simple gm player;
#X obj 8 20 c_midiplay;
#X text 129 21 - midifile player (requires mrpeach [midifile]);
#X connect 5 0 30 0;
#X connect 6 0 30 0;
#X connect 7 0 23 0;
#X connect 9 0 12 0;
#X connect 10 0 30 0;
#X connect 12 0 30 1;
#X connect 13 0 17 0;
#X connect 14 0 30 0;
#X connect 15 0 16 0;
#X connect 16 0 30 0;
#X connect 17 0 30 0;
#X connect 18 0 19 0;
#X connect 18 1 20 0;
#X connect 19 0 24 0;
#X connect 20 0 24 1;
#X connect 21 0 8 0;
#X connect 21 1 18 0;
#X connect 21 2 22 0;
#X connect 23 0 25 0;
#X connect 23 1 26 0;
#X connect 24 0 23 1;
#X connect 27 0 15 0;
#X connect 28 0 16 0;
#X connect 30 0 7 0;
#X connect 30 1 21 0;
#X connect 32 0 16 0;
#X connect 34 0 16 0;
#X connect 35 0 3 0;
#X connect 35 1 3 1;
